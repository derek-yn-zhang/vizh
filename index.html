<!DOCTYPE html>

<html>

	<head>
		<link rel="stylesheet" href="index.css">
		<script src="lib/d3/dist/d3.min.js"></script>
	</head>

	<body>

		<div class="leftpanel">
			<div class="lvspace1"></div>
			<div class="buttonbox">
				<button id="btn1" onclick="whichData(this)">CANNABINOIDS</button><br/>
				<button id="btn2" onclick="whichData(this)">HALLUCINOGENS</button><br/>
				<button id="btn3" onclick="whichData(this)">INHALENTS</button><br/>
				<button id="btn4" onclick="whichData(this)">OPIOIDS</button><br/>
				<button id="btn5" onclick="whichData(this)">ILLEGAL</button><br/>
				<button id="btn6" onclick="whichData(this)">CLEAR</button><br/>
				<!-- <button id="btn7" onClick="window.location.reload();">RESET</button> -->
			</div>
		</div>

		<div class="centerpanel">
			<div class="alignlabs">
				<div class="xlabs">
					<div id="nlab"><p>N</p></div>
					<div id="elab"><p>E</p></div>
					<div id="olab"><p>0</p></div>
					<div id="alab"><p>A</p></div>
					<div id="clab"><p>C</p></div>
					<div id="ilab"><p>I</p></div>
					<div id="slab"><p>S</p></div>
				</div>
			</div>

			<svg class="chart" 
				viewBox="7.36 -50 100 100" 
				preserveAspectRatio="xMidYMid meet">
				<!-- SVG content -->
			</svg>

			<div legend class="legend">
				<!-- legend content -->
				<div>+</div>
				<div id="zero">0</div>
				<div>-</div>
			</div>
		</div>

		<div class="abbr">
			<p>(N)euroticism</p>
			<p>(E)xtraversion</p>
			<p>(O)penness to Experience</p>
			<p>(A)greableness</p>
			<p>(C)onscientousness</p>
			<p>(I)mpulsiveness</p>
			<p>(S)ensation Seeking</p>
		</div>

		<div class="annotations">

		</div>

		<script>

			// var xlab = [ "N","E","O","A","C","I","S" ];
			// 	d3.select(".xlabs")
			// 		.selectAll(null).data(xlab).enter().append("div")
			// 		.text(function(d) { return d; })
			// 		.style("width", 100)
			// 		.style("height", 50)
			// 		.style("text-align", "center");

			// var lastClicked = null;

			function whichData(buttonElement) {

				console.log("in whichData()");

				function getData(buttonElement) {
					if ( buttonClickedId === 'btn1' ) {
						return [ [0.1023,1],[-0.0211,1],[0.3641,1],[-0.1214,1],[-0.2630,1],[0.2708,1],[0.4005,1],
									[-0.1022,0],[0.0208,0],[-0.3651,0],[0.1209,0],[0.2623,0],[-0.2900,0],[-0.4585,0] ];
					}
					else if ( buttonClickedId === 'btn2' ) {
						return [ [0.0726,1],[0.0629,1],[0.4393,1],[-0.1368,1],[-0.2980,1],[0.3575,1],[0.5242,1],
									[-0.0725,0],[-0.0634,0],[-0.4408,0],[0.1362,0],[0.2969,0],[-0.2025,0],[-0.3192,0] ];
					}
					else if ( buttonClickedId === 'btn3' ) {
						return [ [0.1113,1],[-0.0172,1],[0.1916,1],[-0.0951,1],[-0.2033,1],[0.1993,1],[0.2679,1],
									[-0.1112,0],[0.0169,0],[-0.1925,0],[0.0946,0],[0.2026,0],[-0.2396,0],[-0.3517,0] ];
					}
					else if ( buttonClickedId === 'btn4' ) {
						return [ [0.3666,1],[-0.2283,1],[0.3694,1],[-0.3388,1],[-0.3853,1],[0.3731,1],[0.4518,1],
									[-0.3663,0],[0.2274,0],[-0.3723,0],[0.3375,0],[0.3832,0],[-0.0768,0],[-0.1078,0] ];
					}
					else if ( buttonClickedId === 'btn5' ) {
						return [ [0.1527,1],[-0.0395,1],[0.3196,1],[-0.1684,1],[-0.2698,1],[0.2812,1],[0.3777,1],
									[-0.1526,0],[0.0392,0],[-0.3206,0],[0.1679,0],[0.2691,0],[-0.3031,0],[-0.4347,0] ];
					} else if ( buttonClickedId === 'btn6' ) {
						return [ null ];
					}
				}

				// function checkEmpty() {
				// 	if (d3.select(".chart").selectAll("rect").empty()) {
				// 		return true;
				// 	} else {
				// 		return false
				// 	}
				// }

				// console.log(lastClicked != null)

				// if (lastClicked != null) {
				// 	var cachedata = getData(lastClicked);

				// 	d3.select(".chart")
				// 	.selectAll("rect").data(data).enter().insert("rect")
				// 	.attr("width", 74)
				// 	.attr("x", function(d,i) {
				// 		if(d[1] == 1) {
				// 			return 76*i;
				// 		} else {
				// 			return 76*i - 532;
				// 		}
				// 	})
				// 	.attr("y", function(d) { 
				// 			if(d[0] < 0) { return 900 }
				// 		})
				// 	.attr("transform", "translate(100,0)")
				// 	.style("fill-opacity", 1)
				// 		.style("fill", function(d) { 
				// 			if(d[1] == 1) {
				// 				return "red";
				// 			} else {
				// 				return "black";
				// 			}
				// 	});

				// 	initselection = d3.select(".chart").selectAll("rect").data(cachedata);
				// 	initselection.each(function (d) {
				// 		if (d[0] >= 0) {
				// 			d3.select(this)
				// 			.attr("height", function(d) { return 350*d[0]; })
				// 			.attr("y", function(d) { return 900 - 350*d[0]; })
				// 			.transition()
				// 				.delay(50)
				// 				.duration(1000)
				// 				.attr("height", 0)
				// 				.attr("y", 900)
				// 		}
				// 		else if (d[0] < 0) {
				// 			d3.select(this)
				// 			.attr("height", function(d) { return -350*d[0]; })
				// 			.transition()
				// 				.delay(50)
				// 				.duration(1000)
				// 				.attr("height", 0)
				// 		}
				// 	})
				// }

				d3.selectAll("svg > rect").remove();
				d3.selectAll("button").style("border", "5px solid black");

				var buttonClickedId = buttonElement.id;
				d3.select("#" + buttonClickedId).style("border", "5px solid red");
				// lastClicked = buttonClickedId;

				if (buttonClickedId === 'btn4') {
					console.log('4 clicked');
				}

				if (buttonClickedId === 'btn5') {
					console.log('5 clicked');
				}


				var data = getData(buttonClickedId);
				var barwidth = 15.3;
				var barspace = 16.23;
				var groupadjust = 113.57;

				d3.select(".chart")
					.selectAll("rect").data(data).enter()
					.insert("rect")
						.attr("width", barwidth)
						.attr("x", function(d,i) {
							if(d[1] == 1) {
								return barspace*i;
							} 
							else {
								return barspace*i - groupadjust;
							}
						})
						.attr("y", function(d) { 
								if(d[0] < 0) { return 0 }
							})
						// .attr("transform", "translate(7.5,0)")
						.style("fill-opacity", 1)
							.style("fill", function(d) { 
								if(d[1] == 1) {
									return "red";
								} else {
									return "black";
								}
							}
						);

				var selection = d3.select(".chart").selectAll("rect").data(data);
					selection.each(function (d) {
						if (d[0] >= 0) {
							d3.select(this)
							.attr("height", 0)
							.attr("y", 0)
							.transition()
								.delay(50)
								.duration(1000)
								.attr("height", function(d) { return 100*d[0]; })
								.attr("y", function(d) { return -100*d[0]; })
						}
						else if (d[0] < 0) {
							d3.select(this)
							.transition()
								.delay(50)
								.duration(1000)
								.attr("height", function(d) { return -100*d[0]; })
						}

					})

				d3.select(".chart")
					.selectAll(null).data(data).enter()
					.insert("line")
						.style("stroke", function(d) { 
								if(d[1] == 1) {
									return "red";
								} else {
									return "black";
								}
							}
						)
						// .attr("transform", "translate(7.5,0)")
						.attr("x1", function(d,i) {
							if(d[1] == 1) {
								return barspace*i;
							} 
							else {
								return barspace*i - groupadjust;
							}
						})
						.attr("x2", function(d,i) {
							if(d[1] == 1) {
								return barspace*i + barwidth;
							} 
							else {
								return barspace*i - groupadjust + barwidth;
							}
						})
						.attr("y1", function(d,i) { return -100*d[0] })
						.attr("y2", function(d,i) { return -100*d[0] });
			}
		</script>
	</body>
<html>