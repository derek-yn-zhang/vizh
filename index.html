<!DOCTYPE html>

<html></html>

	<head>
		<title>OCEANIS</title>
		<link rel="stylesheet" href="index.css">
		<script src="lib/d3/dist/d3.min.js"></script>
	</head>

	<body>

		<div class="leftpanel">
			<div class="groups">
				<div class="groupbox">
					<div class="legendlab">USER</div>
					<div class="legendcolor"></div>
				</div>
				<div class="groupbox">
					<div class="legendlab" id="nt">NON-USER</div>
					<div class="legendcolor" id="nc"></div>
				</div>
			</div>
			<div class="buttonbox">
				<button id="btn1" onclick="whichData(this)">
					<div class="blabels">Cannabinoids</div>
					<div class="binits">C</div>
				</button>
				<button id="btn2" onclick="whichData(this)">
					<div class="blabels">Hallucinogins</div>
					<div class="binits">H</div>
				</button>
				<button id="btn3" onclick="whichData(this)">
					<div class="blabels">Inhalents</div>
					<div class="binits">IN</div>
				</button>
				<button id="btn4" onclick="whichData(this)">
					<div class="blabels">Opioids</div>
					<div class="binits">O</div>
				</button>
				<button id="btn5" onclick="whichData(this)">
					<div class="blabels">Illegal drugs</div>
					<div class="binits">IL</div>
				</button>
				<button id="btn6" onclick="finalpage()">
					<div class="blabels">CLEAR BARS</div>
					<div class="binits"></div>
				</button>
				<button id="btn7" onClick="window.location.reload();">
					<div class="blabels">RESET</div>
					<div class="binits"></div>
				</button>
			</div>
			<div id="bordercomplete"></div>
		</div>

		<div class="centerpanel">
			<div class="alignlabs">
				<div class="xlabs">
					<div id="olab"><p>O</p></div>
					<div id="clab"><p>C</p></div>
					<div id="elab"><p>E</p></div>
					<div id="alab"><p>A</p></div>
					<div id="nlab"><p>N</p></div>
					<div id="ilab"><p>I</p></div>
					<div id="slab"><p>S</p></div>
				</div>
			</div>

			<div id="tooltip" display="none" style="position: absolute; display: none;"></div>

			<svg class="chart" 
				viewBox="10.5 -55 100 110" 
				preserveAspectRatio="xMidYMid meet">
				<line x1="0" y1="0" x2="122" y2="0" stroke="black" stroke-width="0.1"/>
				<!-- SVG content -->
			</svg>

			<div class="midline"></div>

			<div class="annotations"></div>
		</div>

		<div class="slimpanel">
			<div class="legend">
				<div>+</div>
				<div id="zero">0</div>
				<div>-</div>
			</div>
		</div>

		<div class="rightpanel">
			<div class="annotationbox"></div>
			<div class="content">
				<div class="collapsible-menu">
					<input type="checkbox" class="menu" id="o-menu" onclick="console.log(this.id.toString())">
					<label for="o-menu"><span class="big">O</span>Openness to experience</label>
					<div class="menu-content">
						<p>: a tendency towards intellectual curiosity, aesthetic sensitivity, liberal values, and emotional differentiation.</p>
					</div>
				</div>
				<div class="collapsible-menu">
					<input type="checkbox" class="menu" id="c-menu">
					<label for="c-menu"><span class="big">C</span>Conscientiousness</label>
					<div class="menu-content">
						<p>: the propensity to follow socially prescribed norms for impulse control, to be goal directed, to plan, and to be able to delay gratification.</p>
					</div>
				</div>
				<div class="collapsible-menu">
					<input type="checkbox" class="menu" id="e-menu">
					<label for="e-menu"><span class="big">E</span> Extraversion - Introversion</label>
					<div class="menu-content">
						<p>: a concentration of interest on the external object rather than orientation in life through subjective psychic contents.</p>
					</div>
				</div>
				<div class="collapsible-menu">
					<input type="checkbox" class="menu" id="a-menu">
					<label for="a-menu"><span class="big">A</span>Agreeableness</label>
					<div class="menu-content">
						<p>: the tendency to concur with others, reflecting individual differences in concern with cooperation and social harmony.</p>
					</div>
				</div>
				<div class="collapsible-menu">
					<input type="checkbox" class="menu" id="n-menu">
					<label for="n-menu"><span class="big">N</span>Neuroticism</label>
					<div class="menu-content">
						<p>: the tendency to experience negative emotions, such as anger, anxiety, or depression, and the proneness to psychological distress.</p>
					</div>
				</div>
				<div class="collapsible-menu">
					<input type="checkbox" class="menu" id="i-menu">
					<label for="i-menu"><span class="big">&nbsp;I</span> Impulsiveness</label>
					<div class="menu-content">
						<p>: the tendency to act with less forethought, reflection, or consideration of the consequences than do most individuals of equal ability and knowledge.</p>
					</div>
				</div>
				<div class="collapsible-menu">
					<input type="checkbox" class="menu" id="s-menu">
					<label for="s-menu"><span class="big">S</span>Sensation Seeking</label>
					<div class="menu-content">
						<p>: the seeking of varied, novel, complex and intense sensations and experiences, and the willingness to take risks for the sake of such experience.</p>
					</div>
				</div>
			</div>
		</div>

		<script>

			// var lastClicked = null;

			var menuarr = ["o-menu","c-menu","e-menu","a-menu","n-menu","i-menu","s-menu"];
			function addEventListener(id) {
				document.getElementById(id).addEventListener("input", function (e) {
					if (document.getElementById(this.id).checked) {
						d3.selectAll('.menu').property('checked', false);
						d3.select("#" + this.id).property('checked', true);
					}
				});
			}

			var i;
			for (i = 0; i < menuarr.length; i++) {
				addEventListener(menuarr[i]);
			}

			function finalpage() {
				d3.selectAll('svg > rect').remove();
				d3.select(".chart").selectAll("text").style("opacity", 0.7);
				d3.select(".chart").selectAll("line").style("opacity", 0.7);
				d3.selectAll('ellipse')
					.on('mouseover', function(d, i) {
							d3.select("#s" + this.id.substr(1))
							.transition()
								.duration(800)
								.style("opacity", 0);
							d3.select("#" + this.id.substr(1))
							.transition()
								.duration(800)
								.style("opacity", 0);
						})
						.on('mouseout', function(d, i) {
							d3.select("#s" + this.id.substr(1))
							.transition()
								.delay(600)
								.duration(1500)
								.style("opacity", 1);
							d3.select("#" + this.id.substr(1))
							.transition()
								.delay(800)
								.duration(1000)
								.style("opacity", 1);
						});
			}

			function whichData(buttonElement) {

				function getData(buttonElement) {
					if ( buttonClickedId === 'btn1' ) {
						return [ [0.3641,1,"C"],[-0.2630,1,"C"],[-0.0211,1,"C"],
						[-0.1214,1,"C"],[0.1023,1,"C"],[0.2708,1,"C"],[0.4005,1,"C"],
									[-0.3651,0,"C"],[0.2623,0,"C"],[0.0208,0,"C"],
						[0.1209,0,"C"],[-0.1022,0,"C"],[-0.2900,0,"C"],[-0.4585,0,"C"] ];
					}
					else if ( buttonClickedId === 'btn2' ) {
						return [ [0.4393,1,"H"],[-0.2980,1,"H"],[0.0629,1,"H"],
						[-0.1368,1,"H"],[0.0726,1,"H"],[0.3575,1,"H"],[0.5242,1,"H"],
									[-0.4408,0,"H"],[0.2969,0,"H"],[-0.0634,0,"H"],
						[0.1362,0,"H"],[-0.0725,0,"H"],[-0.2025,0,"H"],[-0.3192,0,"H"] ];
					}
					else if ( buttonClickedId === 'btn3' ) {
						return [ [0.1916,1,"IN"],[-0.2033,1,"IN"],[-0.0172,1,"IN"],
						[-0.0951,1,"IN"],[0.1113,1,"IN"],[0.1993,1,"IN"],[0.2679,1,"IN"],
									[-0.1925,0,"IN"],[0.2026,0,"IN"],[0.0169,0,"IN"],
						[0.0946,0,"IN"],[-0.1112,0,"IN"],[-0.2396,0,"IN"],[-0.3517,0,"IN"] ];
					}
					else if ( buttonClickedId === 'btn4' ) {
						return [ [0.3694,1,"O"],[-0.3853,1,"O"],[-0.2283,1,"O"],
						[-0.3388,1,"O"],[0.3666,1,"O"],[0.3731,1,"O"],[0.4518,1,"O"],
									[-0.3723,0,"O"],[0.3832,0,"O"],[0.2274,0,"O"],
						[0.3375,0,"O"],[-0.3663,0,"O"],[-0.0768,0,"O"],[-0.1078,0,"O"] ];
					}
					else if ( buttonClickedId === 'btn5' ) {
						return [ [0.3196,1,"IL"],[-0.2698,1,"IL"],[-0.0395,1,"IL"],
						[-0.1684,1,"IL"],[0.1527,1,"IL"],[0.2812,1,"IL"],[0.3777,1,"IL"],
									[-0.3206,0,"IL"],[0.2691,0,"IL"],[0.0392,0,"IL"],
						[0.1679,0,"IL"],[-0.1526,0,"IL"],[-0.3031,0,"IL"],[-0.4347,0,"IL"] ];
					}
				}

				// NEOACIS
				// ONEACIS
				// OCNEAIS
				// OCEANIS

				// function checkEmpty() {
				// 	if (d3.select(".chart").selectAll("rect").empty()) {
				// 		return true;
				// 	} else {
				// 		return false
				// 	}
				// }

				// console.log(lastClicked != null)

				// if (lastClicked != null) {
				// 	var cachedata = getData(lastClicked);

				// 	d3.select(".chart")
				// 	.selectAll("rect").data(data).enter().insert("rect")
				// 	.attr("width", 74)
				// 	.attr("x", function(d,i) {
				// 		if(d[1] == 1) {
				// 			return 76*i;
				// 		} else {
				// 			return 76*i - 532;
				// 		}
				// 	})
				// 	.attr("y", function(d) { 
				// 			if(d[0] < 0) { return 900 }
				// 		})
				// 	.attr("transform", "translate(100,0)")
				// 	.style("fill-opacity", 1)
				// 		.style("fill", function(d) { 
				// 			if(d[1] == 1) {
				// 				return "red";
				// 			} else {
				// 				return "black";
				// 			}
				// 	});

				// 	initselection = d3.select(".chart").selectAll("rect").data(cachedata);
				// 	initselection.each(function (d) {
				// 		if (d[0] >= 0) {
				// 			d3.select(this)
				// 			.attr("height", function(d) { return 350*d[0]; })
				// 			.attr("y", function(d) { return 900 - 350*d[0]; })
				// 			.transition()
				// 				.delay(50)
				// 				.duration(1000)
				// 				.attr("height", 0)
				// 				.attr("y", 900)
				// 		}
				// 		else if (d[0] < 0) {
				// 			d3.select(this)
				// 			.attr("height", function(d) { return -350*d[0]; })
				// 			.transition()
				// 				.delay(50)
				// 				.duration(1000)
				// 				.attr("height", 0)
				// 		}
				// 	})
				// }


				d3.selectAll("svg > rect").remove();
				d3.selectAll(".binits").style("color", "black");

				var buttonClickedId = buttonElement.id;
				d3.select("#" + buttonClickedId).select(".binits").style("color", "red");
				// lastClicked = buttonClickedId;

				var data = getData(buttonClickedId);
				var barwidth = 12.2;
				var barspace = 15.2;
				var groupadjust = 106.4;

				d3.select(".chart")
					.selectAll(null).data(data).enter()
					.insert("rect")
						.attr("id", function(d,i) {
							var initid = "rid" + d[0].toString() + d[1].toString() + d[2];
							return initid.replace(/[,.-]/g, '');
						})
						.attr("class", "scalebar")
						.attr("width", barwidth)
						.attr("x", function(d,i) {
							if(d[1] == 1) {
								return barspace*i;
							} 
							else {
								return barspace*i - groupadjust;
							}
						})
						.attr("y", function(d) { 
								if(d[0] < 0) { return 0 }
							})
						.attr("transform", "translate(9.5,0)")
						.style("fill-opacity", 1)
							.style("fill", function(d) { 
								if(d[1] == 1) {
									return "red";
								} else {
									return "black";
								}
							})
						.on('mouseover', function(d, i) {
							d3.select("#s" + this.id.substr(1)).style("opacity", 1);
							console.log("id", this.id);
							console.log("mouseover", d);
						})
						.on('mouseout', function(d, i) {
							d3.select("#s" + this.id.substr(1))
							.transition()
								.delay(1200)
								.duration(400)
								.style("opacity", 0);
							console.log("id", this.id);
							console.log("mouseout", d);
						});;

				var selection = d3.select(".chart").selectAll("rect").data(data);
					selection.each(function (d) {
						if (d[0] >= 0) {
							d3.select(this)
							.attr("height", 0)
							.attr("y", 0)
							.transition()
								.delay(50)
								.duration(1000)
								.attr("height", function(d) { return 100*d[0]; })
								.attr("y", function(d) { return -100*d[0]; })
						}
						else if (d[0] < 0) {
							d3.select(this)
							.transition()
								.delay(50)
								.duration(1000)
								.attr("height", function(d) { return -100*d[0]; })
						}

					})

				d3.select(".chart")
					.selectAll(null).data(data).enter()
					.insert("line")
						.attr("id", function(d,i) {
							var initid = "id" + d[0].toString() + d[1].toString() + d[2];
							return initid.replace(/[,.-]/g, '');
							})
						.transition()
							.delay(50)
							.duration(1000)
							.attr("y1", function(d,i) { return -100*d[0] })
							.attr("y2", function(d,i) { return -100*d[0] })
							.style("opacity", 0.5)
							.style("stroke", function(d) { 
									if(d[1] == 1) {
										return "red";
									} else {
										return "black";
									}
								})
							.attr("transform", "translate(9.5,0)")
							.attr("x1", function(d,i) {
								if(d[1] == 1) {
									return barspace*i;
								} 
								else {
									return barspace*i - groupadjust;
								}
							})
							.attr("x2", function(d,i) {
								if(d[1] == 1) {
									return barspace*i + barwidth;
								} 
								else {
									return barspace*i - groupadjust + barwidth;
								}
							});

				// var shifts = [7.8, -3.2];
				// var xshift = shifts[Math.floor(Math.random() * shifts.length)];
				var xshift = -3.2;
				var group = 
					d3.select(".chart")
					.selectAll(null)
					.data(data)
					.enter()
					.append("g")
						.attr("transform", "translate(" + xshift + "," + 0 + ")")


				group.append("ellipse")
					.attr("id", function(d,i) {
						var initid = "cid" + d[0].toString() + d[1].toString() + d[2];
						return initid.replace(/[,.-]/g, '');
					})
					.attr("cx", function(d,i) {
						if(d[1] == 1) {
							return barspace*i + barwidth + 5;
						} 
						else {
							return barspace*i - groupadjust + barwidth + 5;
						}
					})
					.attr("cy", function(d,i) { return -100*d[0] })
					.attr("ry", 1).attr("rx", 10)
					.attr("fill", "white")
					.attr("stroke", "black")
					.attr("stroke-width", 0.2)
					.style("opacity", 0)
					.on('mouseover', function(d, i) {
							d3.select("#s" + this.id.substr(1)).style("opacity", 1);
							console.log("id", this.id);
							console.log("mouseover", d);
						})
						.on('mouseout', function(d, i) {
							d3.select("#s" + this.id.substr(1))
							.transition()
								.delay(800)
								.duration(400)
								.style("opacity", 0);
							console.log("id", this.id);
							console.log("mouseout", d);
						});

				group.append("text")
					.attr("id", function(d,i) {
						var initid = "sid" + d[0].toString() + d[1].toString() + d[2];
						return initid.replace(/[,.-]/g, '');
					})
					.text(function(d) { return d[2]; })
					.attr("x", function(d,i) {
					if(d[1] == 1) {
						return barspace*i + barwidth - 0.9;
					} 
					else {
						return barspace*i - groupadjust + barwidth - 0.9;
					}
					})
					.attr("y", function(d,i) { return -100*d[0] + 0.65 })
					.attr("text-anchor", "middle")
					.attr("stroke", "black")
					.attr("stroke-width", "0.2px")
					.style("opacity", 0)
					.style("font-family", "'DM' Sans, sans-serif")
					.style("font-weight", "normal")
					.style("font-size", 2);
			}
		</script>
	</body>
<html>